schema: '2.0'
stages:
  fetch:
    cmd: poetry run python src/data/fetch_data.py
    deps:
    - path: src/data/fetch_data.py
      hash: md5
      md5: 5867135077809f48fce60c83bb9fc0f9
      size: 6465
    outs:
    - path: data/raw
      hash: md5
      md5: fcc486fd2be5da32ec2ea133630817ec.dir
      size: 333820
      nfiles: 69
  preprocess:
    cmd: poetry run python src/data/preprocess_data.py
    deps:
    - path: data/raw
      hash: md5
      md5: fcc486fd2be5da32ec2ea133630817ec.dir
      size: 333820
      nfiles: 69
    - path: src/data/preprocess_data.py
      hash: md5
      md5: 0442e88ad2aafa41bdd5e3cc45e3d4e2
      size: 4855
    outs:
    - path: data/processed/combined
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: data/processed/mbajk
      hash: md5
      md5: ad5fac019d479c62ad7ce9d02712322a.dir
      size: 35639
      nfiles: 34
    - path: data/processed/weather
      hash: md5
      md5: 2cf4d0ac8325d62d51e56df71fa2f643.dir
      size: 230202
      nfiles: 34
  split:
    cmd: poetry run python src/data/final_processing.py
    deps:
    - path: data/processed/combined
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: src/data/final_processing.py
      hash: md5
      md5: a6f312adc6982afb88ab0126cc06c9b5
      size: 1434
    outs:
    - path: data/processed/test
      hash: md5
      md5: d96aab6bb375f07147dd08fafe3f55eb.dir
      size: 218874
      nfiles: 34
    - path: data/processed/train
      hash: md5
      md5: 347d19e44e951a2c7ca296c4727341df.dir
      size: 1939663
      nfiles: 34
  reference_data:
    cmd: "mkdir -p data/processed\ncp -r data/processed/combined data/processed/reference_data\n
      cp -r data/processed/combined data/processed/current_data\n"
    deps:
    - path: data/processed/combined
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    outs:
    - path: data/processed/current_data
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: data/processed/reference_data
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
  validate_and_test:
    cmd: poetry run python src/data/validate_and_test.py
    deps:
    - path: data/processed/current_data
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: data/processed/reference_data
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: src/data/validate_and_test.py
      hash: md5
      md5: b190721d53acb9d611ce6c614abaea5f
      size: 5013
  split_data:
    cmd: poetry run python src/data/split_data.py
    deps:
    - path: data/processed/current_data
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: src/data/split_data.py
      hash: md5
      md5: bd02b4c874c5cb7567129a20eade3536
      size: 1768
    outs:
    - path: data/processed/train_test_from_current/test
      hash: md5
      md5: 5615e791bd0d65bb3c3cf950d9a514a4.dir
      size: 222897
      nfiles: 34
    - path: data/processed/train_test_from_current/train
      hash: md5
      md5: 827fff4e7a5717f30c677c6ac012f8b8.dir
      size: 1935640
      nfiles: 34
  train_model_mlflow:
    cmd: poetry run python src/models/train_model_mlflow.py
    deps:
    - path: data/processed/train_test_from_current/train
      hash: md5
      md5: 827fff4e7a5717f30c677c6ac012f8b8.dir
      size: 1935640
      nfiles: 34
    - path: src/models/train_model_mlflow.py
      hash: md5
      md5: 468f74244eb6d41b7c929ff348cdebd2
      size: 3250
    outs:
    - path: models/models_mlflow
      hash: md5
      md5: 7e40002f7b6cd6ecf2fb1dd20ff56ed9.dir
      size: 5989960
      nfiles: 29
  predict_model_mlflow:
    cmd: poetry run python src/models/predict_model_mlflow.py
    deps:
    - path: data/processed/train_test_from_current/test
      hash: md5
      md5: 5615e791bd0d65bb3c3cf950d9a514a4.dir
      size: 222897
      nfiles: 34
    - path: models/models_mlflow
      hash: md5
      md5: 7e40002f7b6cd6ecf2fb1dd20ff56ed9.dir
      size: 5989960
      nfiles: 29
    - path: src/models/predict_model_mlflow.py
      hash: md5
      md5: de173e5fb70077eeefea71675c854b7b
      size: 3066
  merge_data:
    cmd: poetry run python src/data/merge_data.py
    deps:
    - path: data/processed/combined
      hash: md5
      md5: 94a4cc54e196d56822a3a6de4a33d405.dir
      size: 2153777
      nfiles: 34
    - path: src/data/merge_data.py
      hash: md5
      md5: 38afd2c3c3eec28699525e5cdc47106d
      size: 797
    outs:
    - path: data/processed/merged/data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
  reference_data_merged:
    cmd: "cp data/processed/merged/data.csv data/processed/merged/reference_data.csv\n
      cp data/processed/merged/data.csv data/processed/merged/current_data.csv\n"
    deps:
    - path: data/processed/merged/data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
    outs:
    - path: data/processed/merged/current_data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
    - path: data/processed/merged/reference_data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
  validate_and_test_merged:
    cmd: poetry run python src/data/validate_and_test_merged.py
    deps:
    - path: data/processed/merged/current_data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
    - path: data/processed/merged/reference_data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
    - path: src/data/validate_and_test_merged.py
      hash: md5
      md5: 044597704d888f512d8ac109222602bf
      size: 4657
  split_data_merged:
    cmd: poetry run python src/data/split_merged_data.py
    deps:
    - path: data/processed/merged/current_data.csv
      hash: md5
      md5: 61e67ed6c40cd8a6a0e27c60e89b210b
      size: 2149157
    - path: src/data/split_merged_data.py
      hash: md5
      md5: 29991beb32dceefcc8d0285c9a6938cf
      size: 888
    outs:
    - path: data/processed/train_test_merged/test.csv
      hash: md5
      md5: 9ca3ab9f5d4b4acd5ac3e3890db514a8
      size: 215041
    - path: data/processed/train_test_merged/train.csv
      hash: md5
      md5: ff4b1ae5e6b97cd8fb62a61d89fa247f
      size: 1934256
  train_model_mlflow_merged:
    cmd: poetry run python src/models/train_merged_model_mlflow.py
    deps:
    - path: data/processed/train_test_merged/train.csv
      hash: md5
      md5: 0558d00c33c31952b2b2aaf5cacd32bd
      size: 1902948
    - path: src/models/train_merged_model_mlflow.py
      hash: md5
      md5: 2acaec863c6bd705395e98d201bf6c94
      size: 2016
    outs:
    - path: models/models_mlflow_merged
      hash: md5
      md5: fb39149a4607f0ec33938a249fbe1c80.dir
      size: 206806
      nfiles: 1
  predict_model_mlflow_merged:
    cmd: poetry run python src/models/predict_merged_model_mlflow.py
    deps:
    - path: data/processed/train_test_merged/test.csv
      hash: md5
      md5: f1d283c91624220a6e5f755ca84e24fd
      size: 211239
    - path: models/models_mlflow_merged
      hash: md5
      md5: fb39149a4607f0ec33938a249fbe1c80.dir
      size: 206806
      nfiles: 1
    - path: src/models/predict_merged_model_mlflow.py
      hash: md5
      md5: 65ff6395357acebb6c8eb95fb8bac4cc
      size: 1481
  train_model_full_mlflow:
    cmd: poetry run python src/models/train_full_model_mlflow.py
    deps:
    - path: data/processed/train_test_merged/test.csv
      hash: md5
      md5: 9ca3ab9f5d4b4acd5ac3e3890db514a8
      size: 215041
    - path: data/processed/train_test_merged/train.csv
      hash: md5
      md5: ff4b1ae5e6b97cd8fb62a61d89fa247f
      size: 1934256
    - path: src/models/train_full_model_mlflow.py
      hash: md5
      md5: e0266c9ef57d03f5514891340e68943f
      size: 3318
    outs:
    - path: models/models_mlflow_full
      hash: md5
      md5: 095f1b56521ccbd5b2f6cc4a86c5bd8e.dir
      size: 206850
      nfiles: 1
